{% extends "000-base.html" %} {% block content %}
{% include "001-navigation.html" %}
{% include "modals/" + page_info['template_name'] + ".html" ignore missing %}
    <div class="form-floating mb-2">
      <input type="text" class="form-control" id="plex_url" name="plex_url" value="" title="Plex URL" required="">
      <label for="plex_url">Plex URL<span class="text-info ms-2">(e.g. http://127.0.0.1:32400)</span></label>
    </div>
    <div class="input-group mb-2">
      <div class="form-floating flex-grow-1">
        <input type="password" class="form-control" id="plex_token" name="plex_token"
               value="" title="Token"
               aria-label="Plex Token" required="">
        <label for="plex_token">Plex Token</label>
      </div>
      <button class="btn btn-secondary" id="toggleApikeyVisibility" type="button">
        <i class="fas fa-eye"></i>
      </button>
      <button class="btn btn-success" id="validateButton" type="button">
        Validate <i id="spinner_validate" class="spinner-border spinner-border-sm" style="display:none;"></i>
      </button>
    </div>




    <input type="hidden" class="form-control" id="tmp_user_list" name="tmp_user_list" value="{{ data['plex']['tmp_user_list'] }}" title="">
    <input type="hidden" class="form-control" id="tmp_music_libraries" name="tmp_music_libraries" value="{{ data['plex']['tmp_music_libraries'] }}" title="">
    <input type="hidden" class="form-control" id="tmp_movie_libraries" name="tmp_movie_libraries" value="{{ data['plex']['tmp_movie_libraries'] }}" title="">
    <input type="hidden" class="form-control" id="tmp_show_libraries" name="tmp_show_libraries" value="{{ data['plex']['tmp_show_libraries'] }}" title="">
    <div class="form-floating" style="display:none;">
      <input type="text" class="form-control" id="plex_validated" name="plex_validated" value="{{ data['validated'] }}" title="">
      <label for="plex_validated">Plex Validated</label>
    </div>
    <div id="statusMessage" class="status-message"></div>
    <div class="hidden" id="hidden" style="display:none">
      <div class="form-floating mb-2">
        <input type="number" class="form-control" id="plex_db_cache" name="plex_db_cache" value="{{ data['plex']['db_cache'] }}" title="Set the size of the Plex Database Cache (in Megabytes), default is 40" min="40" required="">
        <label for="plex_db_cache">Database Cache Size (in mb)<span class="text-info ms-2">(value obtained automatically from Plex)</span></label>
      </div>
      <div id="plexDbCache" class="status-message"></div>
      <div class="form-floating mb-2">
        <input type="number" class="form-control" id="plex_timeout" name="plex_timeout" value="{{ data['plex']['timeout'] }}" title="Amount of seconds to wait for Plex to respond, default is 60" min="60" required="">
        <label for="plex_timeout">Timeout (in seconds)</label>
      </div>

      <!-- Checkbox handling -->
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" name="plex_verify_ssl" id="plex_verify_ssl" value="true" {% if data['plex']['verify_ssl']|string|lower == 'true' %}checked{% endif %}>
        <input type="hidden" name="plex_verify_ssl" value="false">
        <label class="form-check-label" for="plex_verify_ssl">Verify SSL</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" name="plex_clean_bundles" id="plex_clean_bundles" value="true" {% if data['plex']['clean_bundles']|string|lower == 'true' %}checked{% endif %}>
        <input type="hidden" name="plex_clean_bundles" value="false">
        <label class="form-check-label" for="plex_clean_bundles">Clean bundles</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" name="plex_empty_trash" id="plex_empty_trash" value="true" {% if data['plex']['empty_trash']|string|lower == 'true' %}checked{% endif %}>
        <input type="hidden" name="plex_empty_trash" value="false">
        <label class="form-check-label" for="plex_empty_trash">Empty trash</label>
      </div>
      <div class="form-check form-switch">
        <input class="form-check-input" type="checkbox" name="plex_optimize" id="plex_optimize" value="true" {% if data['plex']['optimize']|string|lower == 'true' %}checked{% endif %}>
        <input type="hidden" name="plex_optimize" value="false">
        <label class="form-check-label" for="plex_optimize">Optimize Database</label>
      </div>
    </div>
  </div>
</form>
{% endblock %}
