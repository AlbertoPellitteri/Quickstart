{% extends "000-base.html" %} {% block content %}
<form method="post" id="configForm" name="configForm">
  <div id="{{ page_info['title'] }}Section">
    <!-- Navigation Bar -->
    <div class="container mt-4">
      <nav class="navbar p-3 rounded shadow bg-transparent">
        <div class="d-flex align-items-center w-100 justify-content-center">

          <!-- Page Title as Dropdown -->
          <div class="dropdown text-center flex-grow-1">
            <button class="btn btn-link dropdown-toggle fs-3 text-white fw-bold" id="navbarDropdownMenuLink" data-bs-toggle="dropdown" aria-expanded="false">
              {{ page_info['title'] }}
            </button>
            <ul class="dropdown-menu text-center" style="left: 50%; transform: translateX(-50%);" aria-labelledby="navbarDropdownMenuLink">
              {% for file, name in template_list %}
                {% if name == 'Final Validation' %}
                  <li><hr class="dropdown-divider"></li>
                {% endif %}
                <li>
                  <a class="dropdown-item" href="javascript:void(0);" onclick="jumpTo('{{ file.rsplit('.', 1)[0] }}')">{{ name }}</a>
                </li>
                {% if name == 'Start' %}
                  <li><hr class="dropdown-divider"></li>
                {% endif %}
              {% endfor %}
            </ul>
          </div>

          <!-- Next Button -->
          <button type="submit" class="btn btn-success ms-auto" onclick="loading('next')" formaction="/step/{{ page_info['next_page'] }}">
            <i id="next-spinner-icon" class="fa fa-arrow-right"></i>
          </button>
        </div>
      </nav>
    </div>

    <!-- Progress Bar -->
    <div class="container text-center mt-3">
      <div class="progress" role="progressbar" aria-valuenow="{{ page_info['progress'] }}" aria-valuemin="0" aria-valuemax="100">
        <div class="progress-bar bg-success" style="width: {{ page_info['progress'] }}%">
          {{ page_info['progress'] }}%
        </div>
      </div>
    </div>

    <hr class="hr">
    {% include "modals/" + page_info['template_name'] + ".html" ignore missing %}
    <center>
      <img src="{{ url_for('static', filename='images/logo.webp') }}"
      alt="Quickstart"
      style="width: 300px; height: auto;" />
    </center>
    <br>
    <div class="form-text" id="pin-info">
      <p class="fs-5">Quickstart is a Web UI that will guide you through creating a Configuration File for Kometa.</p>
      <div class="alert alert-danger" role="alert">
        <strong>Important Notice:</strong> Quickstart is designed to be run by you, on your own machine, to ensure your data and credentials remain secure. All information entered, including credentials, is stored locally on your device, and Quickstart only communicates with third-party services to verify credentials. Kometa does not collect or share any data. We strongly advise against using a version of Quickstart hosted by someone else. For the official repository, visit <a href="https://github.com/Kometa-Team/Quickstart" target="_blank">Quickstart on GitHub</a>.
      </div>
      <p class="fs-5">Minimally, you will need information about your media server (URL and Token) and your TMDb information (API Key) before downloading the final config.yml file.</p>
      <p class="fs-5">Once you have gathered that stuff, click the next "Arrow" above.</p>
    </div>
    <div class="form-text" id="name-info">
      <p class="fs-6">The config name below is used for saving your config and progress on the server. You can change it if you wish before getting started.</p>
      <div class="alert alert-warning" role="alert">
        <strong>Note:</strong> Please write down the config name for future reference. This will help you to retrieve and modify your configuration later.
      </div>
    </div>

    <div class="form-floating mb-3">
      <select id="configSelector" name="configSelector" class="form-select" onchange="toggleConfigInput(this)">
        <option value="add_config" {% if page_info['config_name'] not in available_configs %}selected{% endif %}>
          Add Config
        </option>
        {% for name in available_configs %}
        <option value="{{ name }}" {% if name == page_info['config_name'] %}selected{% endif %}>
          {{ name }}
        </option>
        {% endfor %}
      </select>
      <label for="configSelector">Select or Add Config</label>
    </div>

    <div id="newConfigInput" class="form-floating" style="display: {% if page_info['config_name'] not in available_configs %}block{% else %}none{% endif %};">
      <input
        type="text"
        id="newConfigName"
        name="newConfigName"
        class="form-control"
        placeholder="Enter a new config name"
        value="{% if page_info['config_name'] not in available_configs %}{{ page_info['config_name'] }}{% else %}{{ page_info['new_config_name'] }}{% endif %}"
      >
      <label for="newConfigName">New Config Name</label>
    </div>
  </div>
  <form>
    <div class="d-grid gap-2">
      <a href="#" id="reset">
        <button class="btn btn-danger" type="submit" id="clearSessionButton">Reset and Start Over</button>
      </a>
    </div>
  </form>
</form>
<!-- Toast Notifications -->
<div class="toast-container position-fixed top-0 start-50 translate-middle-x p-3" id="toastContainer"></div>

  <!-- Modal for confirmation -->
<div class="modal fade" id="confirmationModal" tabindex="-1" aria-labelledby="confirmationModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title text-danger" id="confirmationModalLabel">Confirm</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="confirmationModalBody">
        <!-- Dynamic content added via JS -->
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        <button type="button" class="btn btn-danger" id="confirmClearSession">Yes, Reset</button>
      </div>
    </div>
  </div>
</div>
{% endblock %}
